<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bá»‘c LÃ¬ XÃ¬ May Máº¯n - Táº¿t 2026</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="decor-frame noselect">
        <div class="icon i1">ğŸ</div>
        <div class="icon i2">ğŸ§¨</div>
        <div class="icon i3">ğŸŒ¸</div>
        <div class="icon i4">ğŸ®</div>
        <div class="icon i5">ğŸ§§</div>
        <div class="icon i6">ğŸ†</div>
    </div>

    <div class="envelope-container" id="envelope" onclick="openLixi()">
        <div class="envelope-flap"></div>

        <div class="money">
            <div class="img-placeholder">ğŸ’µ</div>
            <div style="font-size: 0.8rem; margin-top:5px; color: #1e3c00;">Bá»C LÃŒ XÃŒ ÄEE</div>
            <div class="money-display" id="rolling-number">000000</div>
        </div>

        <div class="envelope-body">
            <div class="pattern">ç¦</div>
        </div>
    </div>

    <div class="result-overlay" id="overlay">
        <div class="congrats-text">ChÃºc Má»«ng NÄƒm Má»›i!</div>
        <div class="congrats-text" style="font-size: 1.2rem; color: white;">Báº¡n Ä‘Ã£ nháº­n Ä‘Æ°á»£c lÃ¬ xÃ¬:</div>
        <div class="final-amount" id="final-result">500.000</div>
        <div class="message" id="wishes">Váº¡n sá»± nhÆ° Ã½ - Tá»· sá»± nhÆ° mÆ¡!</div>
        <button class="reset-btn" onclick="resetGame()">ChÆ¡i láº¡i</button>
    </div>

    <script>
        let isOpened = false;

        function formatCurrency(number) {
            return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }

        function openLixi() {
            if (isOpened) return; // Cháº·n click nhiá»u láº§n
            isOpened = true;

            const envelope = document.getElementById('envelope');
            const rollingDisplay = document.getElementById('rolling-number');
            const overlay = document.getElementById('overlay');
            const finalResult = document.getElementById('final-result');

            // 1. Má»Ÿ náº¯p
            envelope.classList.add('open');

            // 2. Sau 0.5s thÃ¬ kÃ©o tiá»n lÃªn
            setTimeout(() => {
                envelope.classList.add('pull-money');

                // 3. Báº¯t Ä‘áº§u quay sá»‘ (hiá»‡u á»©ng xá»• sá»‘)
                let duration = 2500; // Quay trong 2.5 giÃ¢y
                let startTime = null;

                // Random sá»‘ tiá»n tá»« 100k Ä‘áº¿n 1tr (lÃ m trÃ²n Ä‘áº¿n hÃ ng nghÃ¬n)
                // CÃ´ng thá»©c: (Random * (Max - Min) + Min)
                // LÃ m trÃ²n cháºµn chá»¥c nghÃ¬n cho Ä‘áº¹p
                let rawAmount = Math.floor(Math.random() * (100 - 1 + 1) + 100) * 1000;

                // Hiá»‡u á»©ng cháº¡y sá»‘
                const animateNumber = (timestamp) => {
                    if (!startTime) startTime = timestamp;
                    const progress = timestamp - startTime;

                    // Trong lÃºc quay, hiá»‡n sá»‘ ngáº«u nhiÃªn
                    if (progress < duration) {
                        let randomTemp = Math.floor(Math.random() * 999999);
                        rollingDisplay.innerText = randomTemp.toString().padStart(6, '0');
                        requestAnimationFrame(animateNumber);
                    } else {
                        // Káº¿t thÃºc quay, hiá»‡n sá»‘ chÃ­nh xÃ¡c
                        rollingDisplay.innerText = formatCurrency(rawAmount);

                        // 4. Hiá»‡n Overlay káº¿t quáº£ sau 0.5s dá»«ng sá»‘
                        setTimeout(() => {
                            showResult(rawAmount);
                        }, 800);
                    }
                };
                requestAnimationFrame(animateNumber);

            }, 600);
        }

        function showResult(amount) {
            const overlay = document.getElementById('overlay');
            const finalResult = document.getElementById('final-result');
            const wishes = document.getElementById('wishes');

            // Format tiá»n cho Ä‘áº¹p
            finalResult.innerText = formatCurrency(amount) + " Ä‘";

            // Random cÃ¢u chÃºc
            const wishList = [
                "Tiá»n vÃ o nhÆ° nÆ°á»›c sÃ´ng ÄÃ !",
                "Hay Äƒn chÃ³ng bÃ©o, tiá»n nhiá»u nhÆ° káº¹o!",
                "Sá»©c khá»e dá»“i dÃ o, tiá»n vÃ o báº¡c tá»‰!",
                "NÄƒm má»›i phÃ¡t tÃ i, váº¡n sá»± nhÆ° Ã½!",
                "CÃ´ng thÃ nh danh toáº¡i, lá»™c lÃ¡ Ä‘áº§y nhÃ !"
            ];
            wishes.innerText = wishList[Math.floor(Math.random() * wishList.length)];

            overlay.classList.add('show');
        }

        function resetGame() {
            // Reset láº¡i tráº¡ng thÃ¡i ban Ä‘áº§u
            isOpened = false;
            const envelope = document.getElementById('envelope');
            const overlay = document.getElementById('overlay');
            const rollingDisplay = document.getElementById('rolling-number');

            overlay.classList.remove('show');
            envelope.classList.remove('pull-money');

            // Äá»£i tiá»n thá»¥t xuá»‘ng rá»“i má»›i Ä‘Ã³ng náº¯p
            setTimeout(() => {
                envelope.classList.remove('open');
                rollingDisplay.innerText = "000000";
            }, 500);
        }
    </script>
</body>

</html>